<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Curso SAP HANA - Funciones Agregadas</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            color: #666;
            font-size: 1.2em;
        }

        .dashboard {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .sidebar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            height: fit-content;
            position: sticky;
            top: 20px;
        }

        .sidebar h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }

        .nav-item {
            padding: 12px 20px;
            margin: 5px 0;
            background: linear-gradient(45deg, #f8f9fa, #e9ecef);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
            font-size: 0.9em;
        }

        .nav-item:hover {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            transform: translateX(10px);
            border-left-color: #fff;
        }

        .nav-item.active {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border-left-color: #fff;
        }

        .mobile-menu-toggle {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            border: none;
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 20px;
            font-size: 1.2em;
            cursor: pointer;
            width: 100%;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        }

        .content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        }

        .section {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section h2 {
            color: #2c3e50;
            font-size: 2em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }

        .concept-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            border-left: 5px solid #667eea;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
        }

        .concept-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .concept-card h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.4em;
        }

        .concept-card p {
            line-height: 1.8;
            color: #555;
            margin-bottom: 15px;
        }

        .concept-card ul {
            margin-left: 20px;
            margin-top: 10px;
        }

        .concept-card li {
            margin: 8px 0;
            color: #555;
        }

        .definition-box {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            border-left: 5px solid #f39c12;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
        }

        .definition-box h3 {
            color: #856404;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .definition-box p {
            color: #856404;
            line-height: 1.8;
            margin-bottom: 10px;
        }

        .example-box {
            background: linear-gradient(135deg, #e8f5e8, #d4edda);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            border-left: 5px solid #27ae60;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
        }

        .example-box h3 {
            color: #155724;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .example-box p {
            color: #155724;
            line-height: 1.8;
            margin-bottom: 10px;
        }

        .example-box ul {
            margin-left: 20px;
            margin-top: 10px;
        }

        .example-box li {
            margin: 8px 0;
            color: #155724;
        }

        .warning-box {
            background: linear-gradient(135deg, #ffebee, #ffcdd2);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            border-left: 5px solid #d32f2f;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
        }

        .warning-box h3 {
            color: #d32f2f;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .warning-box p {
            color: #d32f2f;
            line-height: 1.8;
            margin-bottom: 10px;
        }

        .function-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .function-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .function-card:hover {
            transform: scale(1.05);
        }

        .function-card.mathematical {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
        }

        .function-card.counting {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }

        .function-card.advanced {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
        }

        .function-name {
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .function-description {
            font-size: 1em;
            opacity: 0.9;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: scale(1.05);
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .progress-bar {
            background: #e9ecef;
            border-radius: 10px;
            padding: 3px;
            margin: 20px 0;
        }

        .progress {
            background: linear-gradient(45deg, #667eea, #764ba2);
            height: 20px;
            border-radius: 8px;
            transition: width 0.5s ease;
        }

        .syntax-box {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            margin: 20px 0;
            overflow-x: auto;
            border-left: 5px solid #667eea;
        }

        .syntax-box .keyword {
            color: #63b3ed;
            font-weight: bold;
        }

        .syntax-box .function {
            color: #fbb6ce;
            font-weight: bold;
        }

        .syntax-box .comment {
            color: #68d391;
            font-style: italic;
        }

        .code-example {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            margin: 20px 0;
            overflow-x: auto;
        }

        .code-example .keyword {
            color: #63b3ed;
        }

        .code-example .function {
            color: #fbb6ce;
        }

        .code-example .string {
            color: #68d391;
        }

        .code-example .number {
            color: #f093a3;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .comparison-card {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            padding: 25px;
            border-left: 5px solid #667eea;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
        }

        .comparison-card.with-group {
            border-left-color: #27ae60;
            background: linear-gradient(135deg, #e8f5e8, #d4edda);
        }

        .comparison-card.without-group {
            border-left-color: #3498db;
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
        }

        .comparison-card h4 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .comparison-card.with-group h4 {
            color: #155724;
        }

        .comparison-card.without-group h4 {
            color: #1565c0;
        }

        .count-variants {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .count-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .count-card:hover {
            transform: scale(1.05);
        }

        .count-card.asterisk {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }

        .count-card.column {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
        }

        .count-card.distinct {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .count-variant {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .header {
                padding: 20px;
                margin-bottom: 20px;
            }

            .header h1 {
                font-size: 1.8em;
            }

            .dashboard {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .sidebar {
                position: static;
                padding: 20px;
                order: 2;
            }

            .mobile-menu-toggle {
                display: block;
                order: 1;
            }

            .sidebar.mobile-hidden {
                display: none;
            }

            .content {
                padding: 20px;
                order: 3;
            }

            .section h2 {
                font-size: 1.5em;
            }

            .concept-card, .definition-box, .example-box, .warning-box {
                padding: 20px;
                margin: 15px 0;
            }

            .function-grid, .stats-grid, .count-variants {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .comparison-grid {
                grid-template-columns: 1fr;
            }

            .nav-item {
                padding: 15px 20px;
                font-size: 1em;
                text-align: center;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.5em;
            }

            .content {
                padding: 15px;
            }

            .concept-card, .definition-box, .example-box, .warning-box {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <img src="https://gessof.cl/wp-content/uploads/2025/05/Logo-minimalista-con-simbolismo-global.png" alt="Gessof Logo" style="height: 80px; margin-bottom: 20px; filter: drop-shadow(0 4px 8px rgba(0,0,0,0.1));">
            <h1>Curso SAP HANA</h1>
            <h2 style="color: #667eea; font-size: 1.5em; margin: 10px 0; font-weight: 600;">Clase 036</h2>
            <p>Funciones Agregadas - Operaciones Matem√°ticas sobre Datos</p>
            <div class="progress-bar">
                <div class="progress" style="width: 90%"></div>
            </div>
        </header>

        <div class="dashboard">
            <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">
                üìã Men√∫ de Contenidos
            </button>

            <nav class="sidebar" id="sidebar">
                <h3>Contenidos del M√≥dulo</h3>
                <div class="nav-item active" onclick="showSection('overview')">üìã Resumen General</div>
                <div class="nav-item" onclick="showSection('introduction')">üöÄ Introducci√≥n</div>
                <div class="nav-item" onclick="showSection('basic-functions')">üìä Funciones B√°sicas</div>
                <div class="nav-item" onclick="showSection('count-function')">üî¢ COUNT en Detalle</div>
                <div class="nav-item" onclick="showSection('mathematical-functions')">‚ûï Funciones Matem√°ticas</div>
                <div class="nav-item" onclick="showSection('group-by-relation')">üì¶ Relaci√≥n con GROUP BY</div>
                <div class="nav-item" onclick="showSection('practical-examples')">üí° Ejemplos Pr√°cticos</div>
                <div class="nav-item" onclick="showSection('advanced-functions')">üî¨ Funciones Avanzadas</div>
                <div class="nav-item" onclick="showSection('conclusions')">üéØ Conclusiones</div>
            </nav>

            <main class="content">
                <section id="overview" class="section active">
                    <h2>üìã Resumen General del M√≥dulo</h2>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number">7</div>
                            <div>Funciones Principales</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">üî¢</div>
                            <div>Operaciones Matem√°ticas</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">772</div>
                            <div>Registros de Ejemplo</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">89</div>
                            <div>Clientes √önicos</div>
                        </div>
                    </stats-grid>

                    <div class="concept-card">
                        <h3>üéØ Objetivos del M√≥dulo</h3>
                        <p>En esta clase introduciremos las <strong>funciones agregadas</strong>, tambi√©n conocidas como funciones de agregaci√≥n. Son funciones que realizan <strong>operaciones matem√°ticas sobre los datos</strong> y son capaces de realizarlas pr√°cticamente todas las bases de datos.</p>
                    </div>

                    <div class="function-grid">
                        <div class="function-card counting">
                            <div class="function-name">COUNT</div>
                            <div class="function-description">Cuenta registros</div>
                        </div>
                        <div class="function-card mathematical">
                            <div class="function-name">MIN/MAX</div>
                            <div class="function-description">Valores extremos</div>
                        </div>
                        <div class="function-card mathematical">
                            <div class="function-name">SUM</div>
                            <div class="function-description">Suma valores</div>
                        </div>
                        <div class="function-card mathematical">
                            <div class="function-name">AVG</div>
                            <div class="function-description">Media aritm√©tica</div>
                        </div>
                        <div class="function-card advanced">
                            <div class="function-name">STDDEV</div>
                            <div class="function-description">Desviaci√≥n est√°ndar</div>
                        </div>
                        <div class="function-card advanced">
                            <div class="function-name">VAR</div>
                            <div class="function-description">Varianza</div>
                        </div>
                    </function-grid>

                    <div class="definition-box">
                        <h3>üí° ¬øQu√© Son las Funciones Agregadas?</h3>
                        <p>Son funciones que realizan <strong>operaciones matem√°ticas sobre los datos</strong>. Como otras funciones que hemos visto (CHAR, CURRENT_DATE), nos devuelven valores, pero en este caso realizan <strong>c√°lculos sobre conjuntos de registros</strong>.</p>
                    </definition-box>

                    <div class="concept-card">
                        <h3>üìö Contenido del M√≥dulo</h3>
                        <ul>
                            <li><strong>COUNT:</strong> Conteo de registros con m√∫ltiples variantes</li>
                            <li><strong>MIN/MAX:</strong> Valores m√≠nimos y m√°ximos</li>
                            <li><strong>SUM:</strong> Suma de valores num√©ricos</li>
                            <li><strong>AVG:</strong> Media aritm√©tica de conjuntos</li>
                            <li><strong>Relaci√≥n con GROUP BY:</strong> Agregaciones por grupos</li>
                            <li><strong>Funciones avanzadas:</strong> STDDEV y VAR</li>
                            <li><strong>Casos pr√°cticos:</strong> An√°lisis empresarial con agregados</li>
                        </ul>
                    </concept-card>

                    <div class="example-box">
                        <h3>üìä Datos de Ejemplo</h3>
                        <p>Trabajaremos con la tabla <strong>"pedidos"</strong> que contiene:</p>
                        <ul>
                            <li><strong>772 registros totales</strong></li>
                            <li><strong>89 clientes √∫nicos</strong></li>
                            <li><strong>IDs de pedido del 10,248 al 11,077</strong></li>
                            <li><strong>M√∫ltiples pedidos por cliente</strong></li>
                        </ul>
                    </example-box>
                </section>

                <section id="introduction" class="section">
                    <h2>üöÄ Introducci√≥n a las Funciones Agregadas</h2>
                    
                    <div class="definition-box">
                        <h3>üéØ Definici√≥n Formal</h3>
                        <p>Las funciones agregadas permiten <strong>calcular valores simples de diferentes valores de una columna</strong>. Realizan operaciones matem√°ticas sobre conjuntos de datos y devuelven un √∫nico resultado.</p>
                    </definition-box>

                    <div class="concept-card">
                        <h3>üîß Caracter√≠sticas Fundamentales</h3>
                        <ul>
                            <li><strong>Operan sobre columnas:</strong> Trabajan con los datos de una columna espec√≠fica</li>
                            <li><strong>Retornan un valor:</strong> Muchos registros ‚Üí un resultado</li>
                            <li><strong>Pueden agruparse:</strong> Diferentes resultados por grupo</li>
                            <li><strong>Ignoran NULLs:</strong> (excepto COUNT(*))</li>
                            <li><strong>Compatibles con WHERE:</strong> Se aplican despu√©s del filtrado</li>
                        </ul>
                    </concept-card>

                    <div class="syntax-box">
<span class="keyword">SELECT</span> 
    <span class="function">COUNT</span>(<span class="keyword">*</span>),
    <span class="function">MIN</span>(columna),
    <span class="function">MAX</span>(columna),
    <span class="function">SUM</span>(columna),
    <span class="function">AVG</span>(columna),
    <span class="function">STDDEV</span>(columna),
    <span class="function">VAR</span>(columna)
<span class="keyword">FROM</span> tabla
<span class="keyword">WHERE</span> condiciones
<span class="keyword">GROUP BY</span> columnas;
                    </syntax-box>

                    <div class="concept-card">
                        <h3">üí≠ Contexto en el Curso</h3>
                        <p>Las funciones agregadas son el siguiente paso l√≥gico despu√©s de dominar:</p>
                        <ul>
                            <li><strong>SELECT b√°sico:</strong> Para obtener datos</li>
                            <li><strong>WHERE:</strong> Para filtrar registros</li>
                            <li><strong>ORDER BY:</strong> Para ordenar resultados</li>
                            <li><strong>Funciones b√°sicas:</strong> Como CHAR, CURRENT_DATE</li>
                        </ul>
                    </concept-card>

                    <div class="example-box">
                        <h3">üìù Preparaci√≥n de Datos</h3>
                        <p>Comenzaremos con una consulta b√°sica para entender nuestros datos:</p>
                    </div>

                    <div class="code-example">
<span class="comment">-- Consulta inicial para ver la estructura</span>
<span class="keyword">SELECT</span> * 
<span class="keyword">FROM</span> pedidos 
<span class="keyword">ORDER BY</span> id_pedido <span class="keyword">ASC</span>;

<span class="comment">-- Resultado: 772 registros</span>
<span class="comment">-- IDs desde 10,248 hasta 11,077</span>
<span class="comment">-- M√∫ltiples pedidos por cliente</span>
                    </code>

                    <div class="comparison-grid">
                        <div class="comparison-card without-group">
                            <h4>üîç Sin Funciones Agregadas</h4>
                            <ul>
                                <li>Vemos todos los registros individuales</li>
                                <li>772 filas de resultado</li>
                                <li>Informaci√≥n dispersa</li>
                                <li>Dif√≠cil an√°lisis global</li>
                            </ul>
                        </div>
                        <div class="comparison-card with-group">
                            <h4>üìä Con Funciones Agregadas</h4>
                            <ul>
                                <li>Res√∫menes y totales</li>
                                <li>Una o pocas filas de resultado</li>
                                <li>Informaci√≥n concentrada</li>
                                <li>An√°lisis y decisiones r√°pidas</li>
                            </ul>
                        </div>
                    </comparison-grid>

                    <div class="concept-card">
                        <h3">üé™ Analog√≠a del Circo</h3>
                        <p>Imagina que tienes 772 espectadores en un circo:</p>
                        <ul>
                            <li><strong>Sin agregados:</strong> Lista completa "Juan, Mar√≠a, Pedro..." (772 nombres)</li>
                            <li><strong>COUNT(*):</strong> "Hay 772 espectadores"</li>
                            <li><strong>AVG(edad):</strong> "La edad promedio es 35 a√±os"</li>
                            <li><strong>MAX(edad):</strong> "El m√°s mayor tiene 89 a√±os"</li>
                        </ul>
                    </concept-card>
                </section>

                <section id="basic-functions" class="section">
                    <h2>üìä Funciones Agregadas B√°sicas</h2>
                    
                    <div class="concept-card">
                        <h3">üî¢ Las Cinco Funciones Esenciales</h3>
                        <p>Estas son las funciones agregadas que usar√°s en el 95% de los casos. Son <strong>est√°ndar SQL</strong> y est√°n disponibles en pr√°cticamente todas las bases de datos.</p>
                    </div>

                    <div class="function-grid">
                        <div class="function-card counting">
                            <div class="function-name">COUNT</div>
                            <div class="function-description">
                                Cuenta el n√∫mero de registros<br>
                                <strong>Vers√°til:</strong> *, columna, DISTINCT
                            </div>
                        </div>
                        <div class="function-card mathematical">
                            <div class="function-name">MIN</div>
                            <div class="function-description">
                                Valor m√≠nimo de la columna<br>
                                <strong>Funciona:</strong> N√∫meros, texto, fechas
                            </div>
                        </div>
                        <div class="function-card mathematical">
                            <div class="function-name">MAX</div>
                            <div class="function-description">
                                Valor m√°ximo de la columna<br>
                                <strong>Funciona:</strong> N√∫meros, texto, fechas
                            </div>
                        </div>
                        <div class="function-card mathematical">
                            <div class="function-name">SUM</div>
                            <div class="function-description">
                                Suma todos los valores<br>
                                <strong>Requiere:</strong> Datos num√©ricos
                            </div>
                        </div>
                        <div class="function-card mathematical">
                            <div class="function-name">AVG</div>
                            <div class="function-description">
                                Media aritm√©tica<br>
                                <strong>Requiere:</strong> Datos num√©ricos
                            </div>
                        </div>
                    </function-grid>

                    <div class="example-box">
                        <h3">üìù Ejemplos B√°sicos con la Tabla Pedidos</h3>
                    </div>

                    <div class="code-example">
<span class="comment">-- COUNT: Contar todos los registros</span>
<span class="keyword">SELECT</span> <span class="function">COUNT</span>(*) 
<span class="keyword">FROM</span> pedidos;
<span class="comment">-- Resultado: 772</span>

<span class="comment">-- MIN: ID de pedido m√°s bajo</span>
<span class="keyword">SELECT</span> <span class="function">MIN</span>(id_pedido) 
<span class="keyword">FROM</span> pedidos;
<span class="comment">-- Resultado: 10248</span>

<span class="comment">-- MAX: ID de pedido m√°s alto</span>
<span class="keyword">SELECT</span> <span class="function">MAX</span>(id_pedido) 
<span class="keyword">FROM</span> pedidos;
<span class="comment">-- Resultado: 11077</span>

<span class="comment">-- SUM: Suma de todos los IDs (ejemplo acad√©mico)</span>
<span class="keyword">SELECT</span> <span class="function">SUM</span>(id_pedido) 
<span class="keyword">FROM</span> pedidos;
<span class="comment">-- Resultado: Suma total de todos los IDs</span>

<span class="comment">-- AVG: Promedio de los IDs</span>
<span class="keyword">SELECT</span> <span class="function">AVG</span>(id_pedido) 
<span class="keyword">FROM</span> pedidos;
<span class="comment">-- Resultado: ID promedio</span>
                    </code>

                    <div class="concept-card">
                        <h3">üî§ Funcionamiento con Diferentes Tipos de Datos</h3>
                        <p>Las funciones agregadas se comportan de manera diferente seg√∫n el tipo de datos:</p>
                    </div>

                    <div class="comparison-grid">
                        <div class="comparison-card">
                            <h4">üî¢ Datos Num√©ricos</h4>
                            <ul>
                                <li><strong>COUNT:</strong> ‚úÖ Cuenta registros</li>
                                <li><strong>MIN/MAX:</strong> ‚úÖ Menor/mayor valor</li>
                                <li><strong>SUM:</strong> ‚úÖ Suma matem√°tica</li>
                                <li><strong>AVG:</strong> ‚úÖ Media aritm√©tica</li>
                            </ul>
                        </div>
                        <div class="comparison-card">
                            <h4">üî§ Datos de Texto</h4>
                            <ul>
                                <li><strong>COUNT:</strong> ‚úÖ Cuenta registros</li>
                                <li><strong>MIN/MAX:</strong> ‚úÖ Orden alfab√©tico (A-Z)</li>
                                <li><strong>SUM:</strong> ‚ùå Error de tipo</li>
                                <li><strong>AVG:</strong> ‚ùå Error de tipo</li>
                            </ul>
                        </div>
                    </comparison-grid>

                    <div class="example-box">
                        <h3">üí° Ejemplo con Diferentes Tipos de Datos</h3>
                    </div>

                    <div class="code-example">
<span class="comment">-- ‚úÖ MIN/MAX funcionan con texto (orden alfab√©tico)</span>
<span class="keyword">SELECT</span> 
    <span class="function">MIN</span>(id_cliente) <span class="keyword">AS</span> primer_cliente,
    <span class="function">MAX</span>(id_cliente) <span class="keyword">AS</span> ultimo_cliente
<span class="keyword">FROM</span> pedidos;
<span class="comment">-- Resultado: Primer y √∫ltimo cliente alfab√©ticamente</span>

<span class="comment">-- ‚ùå SUM/AVG no funcionan con texto</span>
<span class="keyword">SELECT</span> <span class="function">SUM</span>(id_cliente) 
<span class="keyword">FROM</span> pedidos;
<span class="comment">-- ERROR: Inconsistencia en tipos de datos</span>
<span class="comment">-- Solo se permiten tipos de datos num√©ricos</span>
                    </code>

                    <div class="warning-box">
                        <h3">‚ö†Ô∏è Errores Comunes con Tipos de Datos</h3>
                        <p><strong>SUM y AVG requieren datos num√©ricos.</strong> Si intentas usarlos con texto o fechas, obtendr√°s un error de "inconsistencia en tipos de datos".</p>
                    </warning-box>
                </section>

                <section id="count-function" class="section">
                    <h2>üî¢ La Funci√≥n COUNT en Detalle</h2>
                    
                    <div class="concept-card">
                        <h3">üéØ COUNT: La M√°s Vers√°til</h3>
                        <p>COUNT es la funci√≥n agregada m√°s utilizada y tiene <strong>tres variantes importantes</strong> que se comportan de manera diferente. Es crucial entender estas diferencias para an√°lisis precisos.</p>
                    </div>

                    <div class="count-variants">
                        <div class="count-card asterisk">
                            <div class="count-variant">COUNT(*)</div>
                            <div>
                                <strong>Cuenta todo</strong><br>
                                ‚Ä¢ Incluye NULLs<br>
                                ‚Ä¢ Incluye duplicados<br>
                                ‚Ä¢ Total de filas
                            </div>
                        </div>
                        <div class="count-card column">
                            <div class="count-variant">COUNT(columna)</div>
                            <div>
                                <strong>Cuenta valores</strong><br>
                                ‚Ä¢ Excluye NULLs<br>
                                ‚Ä¢ Incluye duplicados<br>
                                ‚Ä¢ Solo valores v√°lidos
                            </div>
                        </div>
                        <div class="count-card distinct">
                            <div class="count-variant">COUNT(DISTINCT columna)</div>
                            <div>
                                <strong>Cuenta √∫nicos</strong><br>
                                ‚Ä¢ Excluye NULLs<br>
                                ‚Ä¢ Excluye duplicados<br>
                                ‚Ä¢ Solo valores √∫nicos
                            </div>
                        </div>
                    </div>

                    <div class="definition-box">
                        <h3">üìã Caracter√≠sticas Detalladas de COUNT</h3>
                        <ul>
                            <li><strong>COUNT(*):</strong> Devuelve el n√∫mero de filas total, independientemente de duplicados o NULLs</li>
                            <li><strong>COUNT(columna):</strong> Cuenta registros donde esa columna NO sea NULL</li>
                            <li><strong>COUNT(DISTINCT columna):</strong> Cuenta valores √∫nicos, excluyendo NULLs y duplicados</li>
                        </ul>
                    </definition-box>

                    <div class="example-box">
                        <h3">üìù Ejemplos Pr√°cticos con los Datos</h3>
                    </div>

                    <div class="code-example">
<span class="comment">-- COUNT(*): Total de registros</span>
<span class="keyword">SELECT</span> <span class="function">COUNT</span>(*) <span class="keyword">AS</span> total_pedidos
<span class="keyword">FROM</span> pedidos;
<span class="comment">-- Resultado: 772 (todos los registros)</span>

<span class="comment">-- COUNT(columna): Registros con ID_cliente v√°lido</span>
<span class="keyword">SELECT</span> <span class="function">COUNT</span>(id_cliente) <span class="keyword">AS</span> pedidos_con_cliente
<span class="keyword">FROM</span> pedidos;
<span class="comment">-- Resultado: 772 (no hay NULLs en este caso)</span>

<span class="comment">-- COUNT(DISTINCT): Clientes √∫nicos</span>
<span class="keyword">SELECT</span> <span class="function">COUNT</span>(<span class="keyword">DISTINCT</span> id_cliente) <span class="keyword">AS</span> clientes_unicos
<span class="keyword">FROM</span> pedidos;
<span class="comment">-- Resultado: 89 (clientes √∫nicos)</span>
                    </code>

                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number">772</div>
                            <div>COUNT(*)<br>Total Registros</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">772</div>
                            <div>COUNT(id_cliente)<br>Sin NULLs</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">89</div>
                            <div>COUNT(DISTINCT id_cliente)<br>Clientes √önicos</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">8.7</div>
                            <div>Promedio Pedidos<br>por Cliente</div>
                        </div>
                    </stats-grid>

                    <div class="concept-card">
                        <h3">üí° Interpretaci√≥n de los Resultados</h3>
                        <p>De nuestros datos podemos deducir:</p>
                        <ul>
                            <li><strong>772 pedidos totales</strong> en la base de datos</li>
                            <li><strong>89 clientes √∫nicos</strong> han realizado pedidos</li>
                            <li><strong>Promedio: 8.7 pedidos por cliente</strong> (772 √∑ 89)</li>
                            <li><strong>No hay valores NULL</strong> en id_cliente (772 = 772)</li>
                        </ul>
                    </concept-card>

                    <div class="example-box">
                        <h3">üîç Caso Pr√°ctico: An√°lisis de Clientes</h3>
                    </div>

                    <div class="code-example">
<span class="comment">-- An√°lisis completo con una sola consulta</span>
<span class="keyword">SELECT</span> 
    <span class="function">COUNT</span>(*) <span class="keyword">AS</span> total_pedidos,
    <span class="function">COUNT</span>(<span class="keyword">DISTINCT</span> id_cliente) <span class="keyword">AS</span> clientes_unicos,
    <span class="function">ROUND</span>(<span class="function">COUNT</span>(*)::DECIMAL / <span class="function">COUNT</span>(<span class="keyword">DISTINCT</span> id_cliente), <span class="number">2</span>) <span class="keyword">AS</span> pedidos_por_cliente
<span class="keyword">FROM</span> pedidos;

<span class="comment">-- Resultado combinado:</span>
<span class="comment">-- total_pedidos: 772</span>
<span class="comment">-- clientes_unicos: 89</span>
<span class="comment">-- pedidos_por_cliente: 8.67</span>
                    </code>

                    <div class="warning-box">
                        <h3">‚ö†Ô∏è Importancia en An√°lisis Empresarial</h3>
                        <p>Estas diferencias en COUNT <strong>pueden parecer detalles t√©cnicos</strong>, pero en an√°lisis empresarial son cruciales. Contar mal puede llevar a decisiones incorrectas sobre inventarios, personal, presupuestos, etc.</p>
                    </warning-box>
                </section>

                <section id="mathematical-functions" class="section">
                    <h2">‚ûï Funciones Matem√°ticas: MIN, MAX, SUM, AVG</h2>
                    
                    <div class="concept-card">
                        <h3">üßÆ Operaciones Matem√°ticas Fundamentales</h3>
                        <p>Estas cuatro funciones realizan las <strong>operaciones matem√°ticas m√°s comunes</strong> en an√°lisis de datos. Cada una tiene sus casos de uso espec√≠ficos y limitaciones importantes.</p>
                    </div>

                    <div class="function-grid">
                        <div class="function-card mathematical">
                            <div class="function-name">MIN</div>
                            <div class="function-description">
                                <strong>Encuentra el m√≠nimo</strong><br>
                                ‚Ä¢ Cualquier tipo de dato<br>
                                ‚Ä¢ Orden: num√©rico, alfab√©tico, cronol√≥gico
                            </div>
                        </div>
                        <div class="function-card mathematical">
                            <div class="function-name">MAX</div>
                            <div class="function-description">
                                <strong>Encuentra el m√°ximo</strong><br>
                                ‚Ä¢ Cualquier tipo de dato<br>
                                ‚Ä¢ Orden: num√©rico, alfab√©tico, cronol√≥gico
                            </div>
                        </div>
                        <div class="function-card mathematical">
                            <div class="function-name">SUM</div>
                            <div class="function-description">
                                <strong>Suma matem√°tica</strong><br>
                                ‚Ä¢ Solo datos num√©ricos<br>
                                ‚Ä¢ √ötil para totales financieros
                            </div>
                        </div>
                        <div class="function-card mathematical">
                            <div class="function-name">AVG</div>
                            <div class="function-description">
                                <strong>Promedio aritm√©tico</strong><br>
                                ‚Ä¢ Solo datos num√©ricos<br>
                                ‚Ä¢ √ötil para tendencias
                            </div>
                        </div>
                    </function-grid>

                    <div class="example-box">
                        <h3">üìä Ejemplos con Datos Num√©ricos</h3>
                    </div>

                    <div class="code-example">
<span class="comment">-- MIN: ID de pedido m√°s bajo</span>
<span class="keyword">SELECT</span> <span class="function">MIN</span>(id_pedido) <span class="keyword">AS</span> primer_pedido
<span class="keyword">FROM</span> pedidos;
<span class="comment">-- Resultado: 10248</span>

<span class="comment">-- MAX: ID de pedido m√°s alto</span>
<span class="keyword">SELECT</span> <span class="function">MAX</span>(id_pedido) <span class="keyword">AS</span> ultimo_pedido
<span class="keyword">FROM</span> pedidos;
<span class="comment">-- Resultado: 11077</span>

<span class="comment">-- SUM: Suma total de IDs (ejemplo acad√©mico)</span>
<span class="keyword">SELECT</span> <span class="function">SUM</span>(id_pedido) <span class="keyword">AS</span> suma_ids
<span class="keyword">FROM</span> pedidos;
<span class="comment">-- Resultado: Suma de todos los IDs</span>

<span class="comment">-- AVG: Promedio de IDs</span>
<span class="keyword">SELECT</span> <span class="function">AVG</span>(id_pedido) <span class="keyword">AS</span> promedio_ids
<span class="keyword">FROM</span> pedidos;
<span class="comment">-- Resultado: ID promedio</span>
                    </code>

                    <div class="example-box">
                        <h3">üî§ Ejemplos con Datos de Texto</h3>
                    </div>

                    <div class="code-example">
<span class="comment">-- ‚úÖ MIN/MAX funcionan con texto (orden alfab√©tico)</span>
<span class="keyword">SELECT</span> 
    <span class="function">MIN</span>(id_cliente) <span class="keyword">AS</span> primer_cliente_alfabetico,
    <span class="function">MAX</span>(id_cliente) <span class="keyword">AS</span> ultimo_cliente_alfabetico
<span class="keyword">FROM</span> pedidos;
<span class="comment">-- Resultado: Orden A-Z y Z-A respectivamente</span>

<span class="comment">-- ‚ùå SUM/AVG provocan error con texto</span>
<span class="keyword">SELECT</span> <span class="function">SUM</span>(id_cliente) 
<span class="keyword">FROM</span> pedidos;
<span class="comment">-- ERROR: Inconsistencia en tipos de datos</span>
<span class="comment">-- Solo se permiten tipos de datos num√©ricos</span>
                    </code>

                    <div class="concept-card">
                        <h3">üéØ Casos de Uso Reales</h3>
                        <p>En entornos empresariales, estas funciones se usan para:</p>
                        <ul>
                            <li><strong>MIN/MAX de fechas:</strong> Primera y √∫ltima venta del mes</li>
                            <li><strong>MIN/MAX de precios:</strong> Producto m√°s barato y m√°s caro</li>
                            <li><strong>SUM de montos:</strong> Ingresos totales, gastos totales</li>
                            <li><strong>AVG de calificaciones:</strong> Satisfacci√≥n promedio del cliente</li>
                        </ul>
                    </concept-card>

                    <div class="example-box">
                        <h3">üí∞ Ejemplo Empresarial Realista</h3>
                        <p>Supongamos que tenemos una columna "monto_pedido":</p>
                    </div>

                    <div class="code-example">
<span class="comment">-- An√°lisis financiero completo</span>
<span class="keyword">SELECT</span> 
    <span class="function">COUNT</span>(*) <span class="keyword">AS</span> total_pedidos,
    <span class="function">MIN</span>(monto_pedido) <span class="keyword">AS</span> pedido_minimo,
    <span class="function">MAX</span>(monto_pedido) <span class="keyword">AS</span> pedido_maximo,
    <span class="function">SUM</span>(monto_pedido) <span class="keyword">AS</span> ingresos_totales,
    <span class="function">AVG</span>(monto_pedido) <span class="keyword">AS</span> ticket_promedio
<span class="keyword">FROM</span> pedidos
<span class="keyword">WHERE</span> fecha_pedido >= <span class="string">'2024-01-01'</span>;

<span class="comment">-- Resultado ejemplo:</span>
<span class="comment">-- total_pedidos: 156</span>
<span class="comment">-- pedido_minimo: 15.50</span>
<span class="comment">-- pedido_maximo: 2,450.00</span>
<span class="comment">-- ingresos_totales: 89,750.30</span>
<span class="comment">-- ticket_promedio: 575.32</span>
                    </code>

                    <div class="warning-box">
                        <h3">‚ö†Ô∏è Consideraciones Importantes</h3>
                        <ul>
                            <li><strong>NULLs son ignorados:</strong> No afectan el c√°lculo (excepto COUNT(*))</li>
                            <li><strong>Divisi√≥n por cero:</strong> AVG de una columna sin datos v√°lidos</li>
                            <li><strong>Tipos de datos:</strong> SUM/AVG solo con n√∫meros</li>
                            <li><strong>Precisi√≥n decimal:</strong> AVG puede generar muchos decimales</li>
                        </ul>
                    </warning-box>
                </section>

                <section id="group-by-relation" class="section">
                    <h2">üì¶ Relaci√≥n Fundamental con GROUP BY</h2>
                    
                    <div class="concept-card">
                        <h3">üîó Conexi√≥n Vital</h3>
                        <p>Las funciones agregadas <strong>se encuentran altamente relacionadas con el comando GROUP BY</strong>. Esta relaci√≥n transforma los agregados de herramientas simples a potentes instrumentos de an√°lisis empresarial.</p>
                    </div>

                    <div class="comparison-grid">
                        <div class="comparison-card without-group">
                            <h4">üìä Sin GROUP BY</h4>
                            <ul>
                                <li><strong>Resultado:</strong> Un solo valor</li>
                                <li><strong>Scope:</strong> Toda la tabla</li>
                                <li><strong>Informaci√≥n:</strong> General y sesgada</li>
                                <li><strong>Utilidad:</strong> Totales globales</li>
                            </ul>
                        </div>
                        <div class="comparison-card with-group">
                            <h4">üì¶ Con GROUP BY</h4>
                            <ul>
                                <li><strong>Resultado:</strong> Un valor por grupo</li>
                                <li><strong>Scope:</strong> Cada grupo independiente</li>
                                <li><strong>Informaci√≥n:</strong> Detallada y espec√≠fica</li>
                                <li><strong>Utilidad:</strong> An√°lisis comparativo</li>
                            </ul>
                        </div>
                    </comparison-grid>

                    <div class="definition-box">
                        <h3">üéØ ¬øPor Qu√© Es Tan Importante?</h3>
                        <p>Calcular valores a nivel de toda la tabla nos da <strong>informaci√≥n muy sesgada</strong>. Es como una empresa multinacional que solo mira beneficios globales sin saber de d√≥nde vienen las ganancias o p√©rdidas.</p>
                    </definition-box>

                    <div class="example-box">
                        <h3">üìà Ejemplo: An√°lisis Global vs Por Cliente</h3>
                    </div>

                    <div class="code-example">
<span class="comment">-- SIN GROUP BY: Informaci√≥n sesgada</span>
<span class="keyword">SELECT</span> 
    <span class="function">COUNT</span>(*) <span class="keyword">AS</span> total_pedidos,
    <span class="function">AVG</span>(id_pedido) <span class="keyword">AS</span> promedio_global
<span class="keyword">FROM</span> pedidos;
<span class="comment">-- Resultado: 772 pedidos, promedio general</span>
<span class="comment">-- ¬øPero cu√°les clientes son m√°s importantes?</span>

<span class="comment">-- CON GROUP BY: Informaci√≥n detallada y √∫til</span>
<span class="keyword">SELECT</span> 
    id_cliente,
    <span class="function">COUNT</span>(*) <span class="keyword">AS</span> pedidos_cliente,
    <span class="function">MIN</span>(id_pedido) <span class="keyword">AS</span> primer_pedido,
    <span class="function">MAX</span>(id_pedido) <span class="keyword">AS</span> ultimo_pedido
<span class="keyword">FROM</span> pedidos
<span class="keyword">GROUP BY</span> id_cliente
<span class="keyword">ORDER BY</span> pedidos_cliente <span class="keyword">DESC</span>;
<span class="comment">-- Resultado: Cada cliente con sus estad√≠sticas</span>
                    </code>

                    <div class="example-box">
                        <h3">üíº Resultados del Ejemplo Pr√°ctico</h3>
                    </div>

                    <div class="code-example">
<span class="comment">-- Resultados ejemplo con GROUP BY:</span>
<span class="comment">-- Cliente A: 10 pedidos (excelente cliente)</span>
<span class="comment">-- Cliente B: 9 pedidos (buen cliente)</span>
<span class="comment">-- Cliente C: 6 pedidos (cliente regular)</span>
<span class="comment">-- Cliente D: 1 pedido (cliente ocasional)</span>

<span class="comment">-- Ahora podemos tomar decisiones:</span>
<span class="comment">-- ‚Ä¢ Cuidar a clientes A y B (ofertas especiales)</span>
<span class="comment">-- ‚Ä¢ Ignorar o dar menos prioridad a cliente D</span>
<span class="comment">-- ‚Ä¢ Intentar convertir C en cliente premium</span>
                    </code>

                    <div class="concept-card">
                        <h3">üéØ Estrategias Empresariales Basadas en Agregados</h3>
                        <p>Con funciones agregadas y GROUP BY puedes implementar:</p>
                        <ul>
                            <li><strong>Segmentaci√≥n de clientes:</strong> Premium, regular, ocasional</li>
                            <li><strong>An√°lisis de productos:</strong> M√°s vendidos, menos vendidos</li>
                            <li><strong>Gesti√≥n de recursos:</strong> D√≥nde invertir tiempo y dinero</li>
                            <li><strong>Detecci√≥n de patrones:</strong> Tendencias por regi√≥n, √©poca, etc.</li>
                        </ul>
                    </concept-card>

                    <div class="example-box">
                        <h3">üîç M√°s Ejemplos con GROUP BY</h3>
                    </div>

                    <div class="code-example">
<span class="comment">-- An√°lisis por cliente: pedidos y rango de IDs</span>
<span class="keyword">SELECT</span> 
    id_cliente,
    <span class="function">COUNT</span>(*) <span class="keyword">AS</span> total_pedidos,
    <span class="function">MIN</span>(id_pedido) <span class="keyword">AS</span> id_minimo,
    <span class="function">MAX</span>(id_pedido) <span class="keyword">AS</span> id_maximo,
    <span class="function">SUM</span>(id_pedido) <span class="keyword">AS</span> suma_ids
<span class="keyword">FROM</span> pedidos
<span class="keyword">GROUP BY</span> id_cliente
<span class="keyword">HAVING</span> <span class="function">COUNT</span>(*) > <span class="number">5</span>  <span class="comment">-- Solo clientes con m√°s de 5 pedidos</span>
<span class="keyword">ORDER BY</span> total_pedidos <span class="keyword">DESC</span>;

<span class="comment">-- Resultado: Solo clientes importantes (>5 pedidos)</span>
<span class="comment">-- Ordenados por importancia (m√°s pedidos primero)</span>
                    </code>

                    <div class="concept-card">
                        <h3">üöÄ Escalabilidad del An√°lisis</h3>
                        <p>Este mismo patr√≥n se puede aplicar a cualquier nivel:</p>
                        <ul>
                            <li><strong>GROUP BY regi√≥n:</strong> Ventas por zona geogr√°fica</li>
                            <li><strong>GROUP BY producto:</strong> Performance de cada producto</li>
                            <li><strong>GROUP BY mes:</strong> Tendencias temporales</li>
                            <li><strong>GROUP BY vendedor:</strong> Performance del equipo</li>
                        </ul>
                    </concept-card>
                </section>

                <section id="practical-examples" class="section">
                    <h2">üí° Ejemplos Pr√°cticos y Casos de Uso</h2>
                    
                    <div class="concept-card">
                        <h3">üé™ De la Teor√≠a a la Pr√°ctica</h3>
                        <p>Ahora que entendemos las funciones agregadas individualmente y su relaci√≥n con GROUP BY, veamos <strong>casos pr√°cticos reales</strong> que encontrar√°s en entornos empresariales.</p>
                    </div>

                    <div class="example-box">
                        <h3">üìä Caso 1: Dashboard Ejecutivo</h3>
                        <p>Necesitas crear un resumen ejecutivo con m√©tricas clave:</p>
                    </div>

                    <div class="code-example">
<span class="comment">-- Dashboard ejecutivo en una sola consulta</span>
<span class="keyword">SELECT</span> 
    <span class="string">'Resumen Ejecutivo'</span> <span class="keyword">AS</span> reporte,
    <span class="function">COUNT</span>(*) <span class="keyword">AS</span> total_pedidos,
    <span class="function">COUNT</span>(<span class="keyword">DISTINCT</span> id_cliente) <span class="keyword">AS</span> clientes_activos,
    <span class="function">MIN</span>(id_pedido) <span class="keyword">AS</span> primer_pedido,
    <span class="function">MAX</span>(id_pedido) <span class="keyword">AS</span> ultimo_pedido,
    <span class="function">ROUND</span>(<span class="function">AVG</span>(id_pedido), <span class="number">0</span>) <span class="keyword">AS</span> pedido_promedio
<span class="keyword">FROM</span> pedidos;

<span class="comment">-- Resultado ejemplo:</span>
<span class="comment">-- Resumen Ejecutivo</span>
<span class="comment">-- ‚Ä¢ 772 pedidos procesados</span>
<span class="comment">-- ‚Ä¢ 89 clientes activos</span>
<span class="comment">-- ‚Ä¢ Rango de pedidos: 10248 - 11077</span>
<span class="comment">-- ‚Ä¢ ID promedio: 10663</span>
                    </code>

                    <div class="example-box">
                        <h3">üèÜ Caso 2: Top 10 Clientes M√°s Importantes</h3>
                    </div>

                    <div class="code-example">
<span class="comment">-- Identificar clientes VIP por n√∫mero de pedidos</span>
<span class="keyword">SELECT</span> 
    id_cliente,
    <span class="function">COUNT</span>(*) <span class="keyword">AS</span> total_pedidos,
    <span class="function">MIN</span>(id_pedido) <span class="keyword">AS</span> primer_pedido,
    <span class="function">MAX</span>(id_pedido) <span class="keyword">AS</span> ultimo_pedido,
    <span class="keyword">CASE</span>
        <span class="keyword">WHEN</span> <span class="function">COUNT</span>(*) >= <span class="number">15</span> <span class="keyword">THEN</span> <span class="string">'VIP'</span>
        <span class="keyword">WHEN</span> <span class="function">COUNT</span>(*) >= <span class="number">10</span> <span class="keyword">THEN</span> <span class="string">'Premium'</span>
        <span class="keyword">WHEN</span> <span class="function">COUNT</span>(*) >= <span class="number">5</span> <span class="keyword">THEN</span> <span class="string">'Regular'</span>
        <span class="keyword">ELSE</span> <span class="string">'Ocasional'</span>
    <span class="keyword">END</span> <span class="keyword">AS</span> categoria_cliente
<span class="keyword">FROM</span> pedidos
<span class="keyword">GROUP BY</span> id_cliente
<span class="keyword">ORDER BY</span> total_pedidos <span class="keyword">DESC</span>
<span class="keyword">LIMIT</span> <span class="number">10</span>;

<span class="comment">-- Resultado: Top 10 con categorizaci√≥n autom√°tica</span>
                    </code>

                    <div class="example-box">
                        <h3">üìà Caso 3: An√°lisis de Distribuci√≥n de Clientes</h3>
                    </div>

                    <div class="code-example">
<span class="comment">-- Estad√≠sticas de segmentaci√≥n de clientes</span>
<span class="keyword">SELECT</span> 
    <span class="keyword">CASE</span>
        <span class="keyword">WHEN</span> pedidos_por_cliente >= <span class="number">15</span> <span class="keyword">THEN</span> <span class="string">'VIP (15+)'</span>
        <span class="keyword">WHEN</span> pedidos_por_cliente >= <span class="number">10</span> <span class="keyword">THEN</span> <span class="string">'Premium (10-14)'</span>
        <span class="keyword">WHEN</span> pedidos_por_cliente >= <span class="number">5</span> <span class="keyword">THEN</span> <span class="string">'Regular (5-9)'</span>
        <span class="keyword">ELSE</span> <span class="string">'Ocasional (1-4)'</span>
    <span class="keyword">END</span> <span class="keyword">AS</span> categoria,
    <span class="function">COUNT</span>(*) <span class="keyword">AS</span> cantidad_clientes
<span class="keyword">FROM</span> (
    <span class="keyword">SELECT</span> 
        id_cliente,
        <span class="function">COUNT</span>(*) <span class="keyword">AS</span> pedidos_por_cliente
    <span class="keyword">FROM</span> pedidos
    <span class="keyword">GROUP BY</span> id_cliente
) <span class="keyword">AS</span> cliente_stats
<span class="keyword">GROUP BY</span> 
    <span class="keyword">CASE</span>
        <span class="keyword">WHEN</span> pedidos_por_cliente >= <span class="number">15</span> <span class="keyword">THEN</span> <span class="string">'VIP (15+)'</span>
        <span class="keyword">WHEN</span> pedidos_por_cliente >= <span class="number">10</span> <span class="keyword">THEN</span> <span class="string">'Premium (10-14)'</span>
        <span class="keyword">WHEN</span> pedidos_por_cliente >= <span class="number">5</span> <span class="keyword">THEN</span> <span class="string">'Regular (5-9)'</span>
        <span class="keyword">ELSE</span> <span class="string">'Ocasional (1-4)'</span>
    <span class="keyword">END</span>
<span class="keyword">ORDER BY</span> cantidad_clientes <span class="keyword">DESC</span>;

<span class="comment">-- Resultado ejemplo:</span>
<span class="comment">-- Ocasional (1-4): 45 clientes</span>
<span class="comment">-- Regular (5-9): 28 clientes</span>
<span class="comment">-- Premium (10-14): 12 clientes</span>
<span class="comment">-- VIP (15+): 4 clientes</span>
                    </code>

                    <div class="concept-card">
                        <h3">üíº Decisiones Empresariales Basadas en Datos</h3>
                        <p>Con estos an√°lisis, la empresa puede:</p>
                        <ul>
                            <li><strong>Recursos limitados:</strong> Enfocar atenci√≥n en 4 clientes VIP</li>
                            <li><strong>Estrategias diferenciadas:</strong> Ofertas personalizadas por segmento</li>
                            <li><strong>Conversi√≥n:</strong> Intentar mover clientes de Regular a Premium</li>
                            <li><strong>Retenci√≥n:</strong> Evitar que Premium bajen a Regular</li>
                        </ul>
                    </concept-card>

                    <div class="example-box">
                        <h3">üîÑ Caso 4: Comparativa Temporal</h3>
                        <p>Si tuvi√©ramos fecha de pedidos, podr√≠amos hacer an√°lisis temporales:</p>
                    </div>

                    <div class="code-example">
<span class="comment">-- Ejemplo hipot√©tico con fechas</span>
<span class="keyword">SELECT</span> 
    <span class="function">EXTRACT</span>(<span class="keyword">YEAR</span> <span class="keyword">FROM</span> fecha_pedido) <span class="keyword">AS</span> a√±o,
    <span class="function">EXTRACT</span>(<span class="keyword">MONTH</span> <span class="keyword">FROM</span> fecha_pedido) <span class="keyword">AS</span> mes,
    <span class="function">COUNT</span>(*) <span class="keyword">AS</span> pedidos_del_mes,
    <span class="function">COUNT</span>(<span class="keyword">DISTINCT</span> id_cliente) <span class="keyword">AS</span> clientes_activos_mes,
    <span class="function">AVG</span>(monto_pedido) <span class="keyword">AS</span> ticket_promedio_mes
<span class="keyword">FROM</span> pedidos
<span class="keyword">WHERE</span> fecha_pedido >= <span class="string">'2024-01-01'</span>
<span class="keyword">GROUP BY</span> 
    <span class="function">EXTRACT</span>(<span class="keyword">YEAR</span> <span class="keyword">FROM</span> fecha_pedido),
    <span class="function">EXTRACT</span>(<span class="keyword">MONTH</span> <span class="keyword">FROM</span> fecha_pedido)
<span class="keyword">ORDER BY</span> a√±o, mes;

<span class="comment">-- Resultado: Tendencias mensuales de negocio</span>
                    </code>

                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number">üíé</div>
                            <div>4 Clientes VIP<br>M√°xima Atenci√≥n</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">ü•á</div>
                            <div>12 Clientes Premium<br>Retenci√≥n</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">üìà</div>
                            <div>28 Clientes Regular<br>Conversi√≥n</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">‚ö°</div>
                            <div>45 Clientes Ocasional<br>Activaci√≥n</div>
                        </div>
                    </stats-grid>
                </section>

                <section id="advanced-functions" class="section">
                    <h2">üî¨ Funciones Avanzadas: STDDEV y VAR</h2>
                    
                    <div class="concept-card">
                        <h3">üìä Funciones Estad√≠sticas Especializadas</h3>
                        <p>SAP HANA incluye funciones estad√≠sticas m√°s avanzadas como <strong>STDDEV</strong> (desviaci√≥n est√°ndar) y <strong>VAR</strong> (varianza). Aunque no son est√°ndar SQL y su uso es menos com√∫n, est√°n disponibles para an√°lisis estad√≠sticos especializados.</p>
                    </div>

                    <div class="function-grid">
                        <div class="function-card advanced">
                            <div class="function-name">STDDEV</div>
                            <div class="function-description">
                                <strong>Desviaci√≥n Est√°ndar</strong><br>
                                ‚Ä¢ Mide dispersi√≥n de datos<br>
                                ‚Ä¢ No est√°ndar SQL<br>
                                ‚Ä¢ Uso especializado
                            </div>
                        </div>
                        <div class="function-card advanced">
                            <div class="function-name">VAR</div>
                            <div class="function-description">
                                <strong>Varianza</strong><br>
                                ‚Ä¢ Mide variabilidad<br>
                                ‚Ä¢ No est√°ndar SQL<br>
                                ‚Ä¢ An√°lisis estad√≠stico
                            </div>
                        </div>
                    </function-grid>

                    <div class="warning-box">
                        <h3">‚ö†Ô∏è Limitaciones del Instructor</h3>
                        <p><strong>Transparencia total:</strong> El instructor admite que no domina estas funciones estad√≠sticas. Est√°n incluidas en la documentaci√≥n pero <strong>no son de uso habitual</strong> en el desarrollo t√≠pico de aplicaciones empresariales.</p>
                    </warning-box>

                    <div class="concept-card">
                        <h3">üéØ ¬øCu√°ndo Podr√≠as Necesitarlas?</h3>
                        <p>Estas funciones son √∫tiles en contextos muy espec√≠ficos:</p>
                        <ul>
                            <li><strong>An√°lisis cient√≠fico:</strong> Investigaci√≥n con datos num√©ricos</li>
                            <li><strong>Control de calidad:</strong> Medici√≥n de variabilidad en procesos</li>
                            <li><strong>An√°lisis financiero:</strong> Volatilidad de precios o rendimientos</li>
                            <li><strong>Estudios estad√≠sticos:</strong> Distribuci√≥n de datos</li>
                        </ul>
                    </concept-card>

                    <div class="example-box">
                        <h3">üìù Sintaxis B√°sica (Sin Profundizar)</h3>
                    </div>

                    <div class="code-example">
<span class="comment">-- Sintaxis b√°sica de funciones avanzadas</span>
<span class="keyword">SELECT</span> 
    <span class="function">STDDEV</span>(id_pedido) <span class="keyword">AS</span> desviacion_estandar,
    <span class="function">VAR</span>(id_pedido) <span class="keyword">AS</span> varianza
<span class="keyword">FROM</span> pedidos;

<span class="comment">-- Tambi√©n funcionan con GROUP BY</span>
<span class="keyword">SELECT</span> 
    id_cliente,
    <span class="function">COUNT</span>(*) <span class="keyword">AS</span> pedidos,
    <span class="function">AVG</span>(id_pedido) <span class="keyword">AS</span> promedio,
    <span class="function">STDDEV</span>(id_pedido) <span class="keyword">AS</span> desviacion
<span class="keyword">FROM</span> pedidos
<span class="keyword">GROUP BY</span> id_cliente
<span class="keyword">HAVING</span> <span class="function">COUNT</span>(*) > <span class="number">5</span>;
                    </code>

                    <div class="concept-card">
                        <h3">üè¢ Realidad Empresarial</h3>
                        <p>En la pr√°ctica empresarial real:</p>
                        <ul>
                            <li><strong>95% de casos:</strong> COUNT, MIN, MAX, SUM, AVG son suficientes</li>
                            <li><strong>4% de casos:</strong> Funciones de fecha y texto especializadas</li>
                            <li><strong>1% de casos:</strong> Funciones estad√≠sticas como STDDEV/VAR</li>
                        </ul>
                    </concept-card>

                    <div class="definition-box">
                        <h3">üí° Enfoque Pr√°ctico</h3>
                        <p><strong>Puedes vivir toda tu carrera sin necesitar STDDEV o VAR.</strong> Si alg√∫n d√≠a las necesitas, la documentaci√≥n de SAP HANA tiene ejemplos detallados. Es m√°s importante dominar perfectamente las funciones b√°sicas.</p>
                    </definition-box>

                    <div class="concept-card">
                        <h3">üìö Otras Funciones Agregadas</h3>
                        <p>SAP HANA incluye muchas m√°s funciones agregadas:</p>
                        <ul>
                            <li><strong>MEDIAN:</strong> Mediana de un conjunto de datos</li>
                            <li><strong>PERCENTILE_CONT:</strong> Percentiles continuos</li>
                            <li><strong>STRING_AGG:</strong> Concatenaci√≥n de strings</li>
                            <li><strong>CORR:</strong> Coeficiente de correlaci√≥n</li>
                        </ul>
                        <p>Pero nuevamente, <strong>son casos muy especializados</strong> que raramente encontrar√°s en desarrollo empresarial t√≠pico.</p>
                    </concept-card>

                    <div class="example-box">
                        <h3">üéØ Recomendaci√≥n Final</h3>
                        <p>Conc√©ntrate en dominar perfectamente:</p>
                        <ol>
                            <li><strong>COUNT</strong> (todas sus variantes)</li>
                            <li><strong>MIN y MAX</strong> (cualquier tipo de dato)</li>
                            <li><strong>SUM y AVG</strong> (datos num√©ricos)</li>
                            <li><strong>Su relaci√≥n con GROUP BY</strong></li>
                        </ol>
                        <p>Con estas cinco funciones puedes resolver el 99% de necesidades empresariales reales.</p>
                    </example-box>
                </section>

                <section id="conclusions" class="section">
                    <h2">üéØ Conclusiones</h2>
                    
                    <div class="concept-card">
                        <h3">üìã Resumen de Funciones Agregadas Dominadas</h3>
                        <p>Hemos explorado las <strong>funciones agregadas</strong>, herramientas fundamentales para realizar operaciones matem√°ticas sobre conjuntos de datos. Estas funciones transforman m√∫ltiples registros en informaci√≥n resumida y accionable.</p>
                    </div>

                    <div class="function-grid">
                        <div class="function-card counting">
                            <div class="function-name">‚úÖ COUNT</div>
                            <div class="function-description">
                                <strong>Dominada Completamente</strong><br>
                                *, columna, DISTINCT<br>
                                La m√°s vers√°til y utilizada
                            </div>
                        </div>
                        <div class="function-card mathematical">
                            <div class="function-name">‚úÖ MIN/MAX</div>
                            <div class="function-description">
                                <strong>Dominadas Completamente</strong><br>
                                Cualquier tipo de dato<br>
                                Valores extremos
                            </div>
                        </div>
                        <div class="function-card mathematical">
                            <div class="function-name">‚úÖ SUM/AVG</div>
                            <div class="function-description">
                                <strong>Dominadas Completamente</strong><br>
                                Solo datos num√©ricos<br>
                                Totales y promedios
                            </div>
                        </div>
                        <div class="function-card advanced">
                            <div class="function-name">üìã STDDEV/VAR</div>
                            <div class="function-description">
                                <strong>Conocidas Superficialmente</strong><br>
                                Funciones estad√≠sticas<br>
                                Uso muy especializado
                            </div>
                        </div>
                    </function-grid>

                    <div class="concept-card">
                        <h3">üîë Conceptos Clave Aprendidos</h3>
                        <ul>
                            <li><strong>Operaciones matem√°ticas:</strong> Transformar m√∫ltiples valores en uno solo</li>
                            <li><strong>Tipos de datos importantes:</strong> Algunas funciones solo con n√∫meros</li>
                            <li><strong>COUNT tiene variantes:</strong> *, columna, DISTINCT con comportamientos diferentes</li>
                            <li><strong>GROUP BY es esencial:</strong> Cambia de totales globales a an√°lisis detallado</li>
                            <li><strong>Aplicaci√≥n empresarial:</strong> Segmentaci√≥n de clientes y toma de decisiones</li>
                        </ul>
                    </concept-card>

                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number">772</div>
                            <div>Registros Analizados<br>Tabla Pedidos</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">89</div>
                            <div>Clientes √önicos<br>COUNT(DISTINCT)</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">5</div>
                            <div>Funciones B√°sicas<br>Uso Diario</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">2</div>
                            <div>Funciones Avanzadas<br>Uso Especializado</div>
                        </div>
                    </stats-grid>

                    <div class="comparison-grid">
                        <div class="comparison-card without-group">
                            <h4">‚ùå An√°lisis Sesgado</h4>
                            <ul>
                                <li><strong>Sin GROUP BY:</strong> Informaci√≥n global</li>
                                <li><strong>Ejemplo:</strong> "772 pedidos totales"</li>
                                <li><strong>Problema:</strong> No sabemos distribuci√≥n</li>
                                <li><strong>Decisi√≥n:</strong> Imposible estrategia espec√≠fica</li>
                            </ul>
                        </div>
                        <div class="comparison-card with-group">
                            <h4">‚úÖ An√°lisis Estrat√©gico</h4>
                            <ul>
                                <li><strong>Con GROUP BY:</strong> Informaci√≥n segmentada</li>
                                <li><strong>Ejemplo:</strong> "4 VIP, 12 Premium, 28 Regular"</li>
                                <li><strong>Soluci√≥n:</strong> Distribuci√≥n clara</li>
                                <li><strong>Decisi√≥n:</strong> Estrategias diferenciadas</li>
                            </ul>
                        </div>
                    </comparison-grid>

                    <div class="concept-card">
                        <h3">üöÄ Aplicaci√≥n Inmediata</h3>
                        <p>Con las funciones agregadas puedes crear:</p>
                        <ul>
                            <li><strong>Dashboards ejecutivos:</strong> M√©tricas clave de un vistazo</li>
                            <li><strong>Segmentaci√≥n de clientes:</strong> VIP, Premium, Regular, Ocasional</li>
                            <li><strong>An√°lisis de performance:</strong> Productos, vendedores, regiones</li>
                            <li><strong>Reportes financieros:</strong> Totales, promedios, extremos</li>
                            <li><strong>Control de calidad:</strong> Detecci√≥n de anomal√≠as</li>
                        </ul>
                    </concept-card>

                    <div class="definition-box">
                        <h3">üí° Lecci√≥n Empresarial Fundamental</h3>
                        <p>Las funciones agregadas convierten <strong>datos en informaci√≥n</strong> e <strong>informaci√≥n en decisiones</strong>. No es solo sobre sintaxis SQL, sino sobre transformar n√∫meros en estrategia empresarial.</p>
                    </definition-box>

                    <div class="concept-card">
                        <h3">üìö Siguientes Pasos en el Curso</h3>
                        <p>Con las funciones agregadas dominadas, est√°s preparado para:</p>
                        <ul>
                            <li><strong>GROUP BY avanzado:</strong> Agrupaciones m√∫ltiples y complejas</li>
                            <li><strong>HAVING:</strong> Filtros sobre resultados agregados</li>
                            <li><strong>Subconsultas:</strong> Consultas dentro de consultas</li>
                            <li><strong>JOINs:</strong> Combinar datos de m√∫ltiples tablas</li>
                            <li><strong>Funciones de ventana:</strong> An√°lisis avanzados</li>
                        </ul>
                    </concept-card>

                    <div class="example-box">
                        <h3">üéØ Pr√°ctica Recomendada</h3>
                        <p>Para afianzar estos conocimientos:</p>
                        <ol>
                            <li><strong>Practica con tus propios datos</strong></li>
                            <li><strong>Combina m√∫ltiples funciones en una consulta</strong></li>
                            <li><strong>Experimenta con diferentes GROUP BY</strong></li>
                            <li><strong>Piensa en aplicaciones empresariales reales</strong></li>
                        </ol>
                    </example-box>

                    <div class="concept-card">
                        <h3">üéâ ¬°Enhorabuena!</h3>
                        <p>Has completado el m√≥dulo de funciones agregadas. Ahora posees herramientas poderosas para an√°lisis de datos y toma de decisiones empresariales. <strong>¬°Sigue practicando y nos vemos en la pr√≥xima clase!</strong></p>
                    </concept-card>
                </section>
            </main>
        </div>
    </div>

    <script>
        function showSection(sectionId) {
            // Ocultar todas las secciones
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => {
                section.classList.remove('active');
            });
            
            // Mostrar la secci√≥n seleccionada
            document.getElementById(sectionId).classList.add('active');
            
            // Actualizar navegaci√≥n
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                item.classList.remove('active');
            });
            
            // Marcar el elemento activo
            event.target.classList.add('active');
            
            // Scroll al inicio del contenido
            document.querySelector('.content').scrollTop = 0;

            // En m√≥viles, ocultar el men√∫ despu√©s de seleccionar
            if (window.innerWidth <= 768) {
                const sidebar = document.getElementById('sidebar');
                sidebar.classList.add('mobile-hidden');
                
                const toggleButton = document.querySelector('.mobile-menu-toggle');
                toggleButton.textContent = 'üìã Men√∫ de Contenidos';
            }
        }

        function toggleMobileMenu() {
            const sidebar = document.getElementById('sidebar');
            const toggleButton = document.querySelector('.mobile-menu-toggle');
            
            if (sidebar.classList.contains('mobile-hidden')) {
                sidebar.classList.remove('mobile-hidden');
                toggleButton.textContent = '‚ùå Cerrar Men√∫';
            } else {
                sidebar.classList.add('mobile-hidden');
                toggleButton.textContent = 'üìã Men√∫ de Contenidos';
            }
        }

        // Inicializar en m√≥viles
        document.addEventListener('DOMContentLoaded', function() {
            if (window.innerWidth <= 768) {
                const sidebar = document.getElementById('sidebar');
                sidebar.classList.add('mobile-hidden');
            }

            // Animaci√≥n de entrada
            const cards = document.querySelectorAll('.concept-card, .definition-box, .example-box, .warning-box');
            cards.forEach((card, index) => {
                setTimeout(() => {
                    card.style.opacity = '0';
                    card.style.transform = 'translateY(20px)';
                    card.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                    
                    setTimeout(() => {
                        card.style.opacity = '1';
                        card.style.transform = 'translateY(0)';
                    }, 100);
                }, index * 100);
            });
        });

        // Manejar cambios de tama√±o de ventana
        window.addEventListener('resize', function() {
            const sidebar = document.getElementById('sidebar');
            const toggleButton = document.querySelector('.mobile-menu-toggle');
            
            if (window.innerWidth > 768) {
                sidebar.classList.remove('mobile-hidden');
                toggleButton.textContent = 'üìã Men√∫ de Contenidos';
            } else if (window.innerWidth <= 768 && !sidebar.classList.contains('mobile-hidden')) {
                sidebar.classList.add('mobile-hidden');
            }
        });
    </script>
</body>
</html>